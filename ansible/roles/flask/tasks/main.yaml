- name: create flask directory 
  file:
    path: "{{ image_directory }}/backend"
    recurse: yes
    state: directory

- name: copy flask dockerfile
  copy: 
    src: ./images/backend/Dockerfile
    dest: "{{ image_directory }}/backend/Dockerfile"

- name: copy flaskProject
  copy:
    src: flaskProject 
    dest: "{{ image_directory }}/backend/"

- name: build flask image
  docker_image: 
    name: backend
    tag: latest 
    source: build 
    build:
      path: "{{ image_directory }}/backend"
      pull: false 
    state: present

- name: run a flask container
  docker_container:
    image: backend:latest 
    name: flask
    state: started 
    ports: 
      - 8081:8081
      - 5000:5000